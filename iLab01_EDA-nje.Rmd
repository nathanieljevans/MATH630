---
title: "iLab 01 - EDA"
author: "Nathaniel Evans"
date: "October 1, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(tidyverse) # all the good stuff
library(readxl) # for reading in xlsx files
library(here) # for here!
library(janitor) # for clean_names & tabyl
library(knitr) # for kable

library(reprohealth)
data <- wb_reprohealth %>% mutate(year=parse_number(year))
head(data)
```
## **reprohealth EDA**
###How many variables/columns?
There are 9 variables of types character (3) and numeric (6)  
```{r}
summary(data)
```
##How many rows/observations?
There are 3296 rows in this dataset.   
```{r}
n_rows <- data %>% count()
print(n_rows)
```
##Which variables are numbers?
The following variables are numeric of type <dbl> :   
* year  
* edu_gen_parity  
* gdp_per_cap  
* life_exp  
* mat_mortality  
* tot_fertility  
```{r}
data %>% glimpse()
```
##Which are categorical variables (numeric or character variables with variables that have a fixed and known set of possible values; aka factor variables)?
The three character types and year have set possible values:  
* year (16) [2000-2015]   
  + technically of type <dbl> but since it's a year, they must be ints within bounded   possible years (eg no years before XX and no years after 2018 -today!) so it _can_ be treated as a factor. Not sure if you'd want to or not though.     
* country (206)  
* continent (5)  
* region (22)  
```{r}
yrs <- data %>% distinct(year) %>% count()
cntry <- data %>% distinct(country) %>% count()
cntnt <- data %>% distinct(continent) %>% count()
rgn <- data %>% distinct(region) %>% count()

print(c("distinct years: ", yrs))
print(c("distinct countries: ", cntry))
print(c("distinct continents: ", cntnt))
print(c("distinct regions: ", rgn))

data$year %>% summary()

```
Complete this sentence: "There is one row per." **observation**
```{r}
head(data)
```

# Part 2 -------------------------------
## Gapminder + new data source

```{r}
setwd("C:/Users/natha/Documents")
alc <- read_xlsx(("indicator alcohol consumption  20100830.xlsx"),
                      sheet = 1) %>% 
                      clean_names() # highly recommended

alc2 <- alc %>%
  rename(country = 1) %>% 
  gather(year, x1, -country) %>% 
  mutate(year = readr::parse_number(year)) %>% 
  filter(!is.na(x1))

glimpse(alc2)
```

###How many variables/columns?  
3: chr(1) and dbl(2)  

###How many rows/observations? 
411 observations (after dropping na's)  

###Which variables are numbers?  
year and x1 (alc consumption (Liters)) 

###Which are categorical variables (numeric or character variables with variables that have a fixed and known set of possible values; aka factor variables)?   
Just country. 
   
###Complete this sentence: "There is one row per." 
*observation* or specifically *observation characterizing year, country and avg consumption of alcohol in pop >= 15 yo*

## joining the data (tables)
```{r}
data_jnd <- left_join(data, alc2) 
glimpse(data_jnd)
```
#Part 3
### "Your goal during EDA is to develop an understanding of your data. The easiest way to do this is to use questions as tools to guide your investigation.EDA is fundamentally a creative process. And like most creative processes, the key to asking quality questions is to generate a large quantity of questions." 

Your mission in this last section is to pick at least three of the tasks below and attack each with a table and figure. In your narrative, reword each "task" into a logical research question(s). Make observations about what your tables/figures show and about the process. If you want to do something comparable but different, i.e. swap one quantitative variable for another, be our guest! If you are feeling inspired and curious, then we're doing this right. Go for it.

Task menu
Get the maximum and minimum of children per woman (tot_fertility) for all continents.

Look at the spread of children per woman (tot_fertility) across countries within the continents.

Compute a trimmed mean of maternal mortality (mat_mortality) for different years. Or a weighted mean, weighting by population. Just try something other than the plain vanilla mean.

How does maternal mortality (mat_mortality) vary across different continents?

Report the absolute and/or relative abundance of countries with low maternal mortality (mat_mortality) over time by continent: Compute some measure of worldwide maternal mortality - you decide - a mean or median or some other quantile or perhaps your current age. Then determine how many countries on each continent have a maternal mortality rate less than this benchmark, for each year.

Find countries with interesting stories. Open-ended and, therefore, hard. Promising but unsuccessful attempts are encouraged. This will generate interesting questions to follow up on in class.

Make up your own! Between the coverage in class, readings, and DataCamp plus the list above, you get the idea.

Companion graphs
For each table, make sure to include a relevant figure. One tip for starting is to draw out on paper what you want your x- and y-axis to be first and what your geom is; that is, start by drawing the plot you want ggplot to give you.

Your figure does not have to depict every last number from the data aggregation result. Use your judgement. It just needs to complement the table, add context, and allow for some sanity checking both ways.

Notice which figures are easy/hard to make, which data formats make better inputs for plotting functions vs. for human-friendly tables.

Report your process
You're encouraged to reflect on what was hard/easy, problems you solved, helpful tutorials you read, etc. Give credit to your sources, whether it's a blog post, a fellow student, an online tutorial, etc.
